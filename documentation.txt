# Django Real-time Chat Application - Complete Documentation

## üìã Table of Contents
1. [Project Overview](#project-overview)
2. [Features](#features)
3. [Installation Guide](#installation-guide)
4. [File Structure](#file-structure)
5. [Database Models](#database-models)
6. [Views Explanation](#views-explanation)
7. [URLs Configuration](#urls-configuration)
8. [Templates Guide](#templates-guide)
9. [AJAX Implementation](#ajax-implementation)
10. [API Endpoints](#api-endpoints)
11. [Usage Guide](#usage-guide)
12. [Troubleshooting](#troubleshooting)

---

## üéØ Project Overview

‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø Django-based real-time chat application ‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá users ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá friend request ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç chat ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§ Application ‡¶ü‡¶ø AJAX ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá real-time messaging support ‡¶ï‡¶∞‡ßá‡•§

### Technology Stack
- **Backend**: Django 4.x+
- **Frontend**: HTML5, CSS3, Vanilla JavaScript
- **Database**: SQLite (default) / PostgreSQL
- **AJAX**: Fetch API
- **Authentication**: Django built-in auth system

---

## ‚ú® Features

### User Management
- ‚úÖ User Registration (Signup)
- ‚úÖ User Login/Logout
- ‚úÖ User Authentication & Authorization
- ‚úÖ User Profile Display

### Friend System
- ‚úÖ View all registered users
- ‚úÖ Send friend requests
- ‚úÖ Accept/Reject friend requests
- ‚úÖ View pending requests
- ‚úÖ View friends list

### Chat System
- ‚úÖ Real-time messaging (AJAX-based)
- ‚úÖ One-on-one chat with friends
- ‚úÖ Message history
- ‚úÖ Auto-refresh messages (every 2 seconds)
- ‚úÖ Read/Unread message status
- ‚úÖ Messenger-style UI

---

## üöÄ Installation Guide

### Prerequisites
- Python 3.8 or higher
- pip (Python package manager)
- Virtual environment (recommended)

### Step 1: Create Virtual Environment
```bash
# Create virtual environment
python -m venv venv

# Activate virtual environment
# Windows:
venv\Scripts\activate
# Mac/Linux:
source venv/bin/activate
```

### Step 2: Install Django
```bash
pip install django
```

### Step 3: Create Django Project
```bash
django-admin startproject messenger
cd messenger
```

### Step 4: Create App
```bash
python manage.py startapp start_messiging
```

### Step 5: Add App to Settings
`messenger/settings.py`:
```python
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'start_messiging',  # Add this line
]
```

### Step 6: Configure URLs
`messenger/urls.py`:
```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('start_messiging.urls')),
]
```

### Step 7: Run Migrations
```bash
python manage.py makemigrations
python manage.py migrate
```

### Step 8: Create Superuser (Optional)
```bash
python manage.py createsuperuser
```

### Step 9: Run Server
```bash
python manage.py runserver
```

Visit: `http://127.0.0.1:8000/`

---

## üìÅ File Structure

```
messenger/
‚îú‚îÄ‚îÄ messenger/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ settings.py
‚îÇ   ‚îú‚îÄ‚îÄ urls.py
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py
‚îú‚îÄ‚îÄ start_messiging/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ start_messiging/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ home.html
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ login.html
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ signup.html
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ connect.html
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ chat.html
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ admin.py
‚îÇ   ‚îú‚îÄ‚îÄ apps.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ views.py
‚îÇ   ‚îú‚îÄ‚îÄ urls.py
‚îÇ   ‚îî‚îÄ‚îÄ tests.py
‚îú‚îÄ‚îÄ db.sqlite3
‚îî‚îÄ‚îÄ manage.py
```

---

## üóÑÔ∏è Database Models

### 1. FriendRequest Model
```python
class FriendRequest(models.Model):
    from_user = models.ForeignKey(User, related_name='sent_requests', on_delete=models.CASCADE)
    to_user = models.ForeignKey(User, related_name='received_requests', on_delete=models.CASCADE)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ('from_user', 'to_user')
```

**Purpose**: Friend request ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Fields**:
- `from_user`: ‡¶Ø‡ßá user request ‡¶™‡¶æ‡¶†‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá
- `to_user`: ‡¶Ø‡ßá user request ‡¶™‡ßá‡¶Ø‡¶º‡ßá‡¶õ‡ßá
- `created_at`: Request ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º

**Constraints**:
- ‡¶è‡¶ï‡¶á user ‡¶ï‡ßá ‡¶è‡¶ï‡¶æ‡¶ß‡¶ø‡¶ï‡¶¨‡¶æ‡¶∞ request ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶¨‡ßá ‡¶®‡¶æ (unique_together)

---

### 2. Friendship Model
```python
class Friendship(models.Model):
    user1 = models.ForeignKey(User, related_name='friendships_initiated', on_delete=models.CASCADE)
    user2 = models.ForeignKey(User, related_name='friendships_received', on_delete=models.CASCADE)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ('user1', 'user2')
```

**Purpose**: Friend relationship store ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Fields**:
- `user1`: ‡¶™‡ßç‡¶∞‡¶•‡¶Æ user
- `user2`: ‡¶¶‡ßç‡¶¨‡¶ø‡¶§‡ßÄ‡¶Ø‡¶º user
- `created_at`: Friendship ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º

**Constraints**:
- ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® user ‡¶è‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶è‡¶ï‡¶ü‡¶ø‡¶á friendship ‡¶•‡¶æ‡¶ï‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá

---

### 3. Message Model
```python
class Message(models.Model):
    sender = models.ForeignKey(User, related_name='sent_messages', on_delete=models.CASCADE)
    receiver = models.ForeignKey(User, related_name='received_messages', on_delete=models.CASCADE)
    content = models.TextField()
    timestamp = models.DateTimeField(auto_now_add=True)
    is_read = models.BooleanField(default=False)
    
    class Meta:
        ordering = ['timestamp']
```

**Purpose**: Chat messages store ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Fields**:
- `sender`: ‡¶Ø‡ßá message ‡¶™‡¶æ‡¶†‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá
- `receiver`: ‡¶Ø‡ßá message ‡¶™‡ßá‡¶Ø‡¶º‡ßá‡¶õ‡ßá
- `content`: Message ‡¶è‡¶∞ content
- `timestamp`: Message ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º
- `is_read`: Message ‡¶™‡¶°‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ

**Ordering**: timestamp ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡¶Ø‡¶º‡ßÄ ascending order

---

## üîß Views Explanation

### 1. Home View
```python
def home(request):
    return render(request, 'start_messiging/home.html')
```

**Purpose**: Landing page ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Template**: `home.html`

**Features**:
- Logged in users ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá ‡¶§‡¶æ‡¶∞‡¶æ login ‡¶ï‡¶∞‡¶æ
- Logged out users signup/login option ‡¶™‡¶æ‡¶Ø‡¶º

---

### 2. Login View
```python
def view_login(request):
    if request.method == "POST":
        username = request.POST.get('username')
        password = request.POST.get('password')
        
        user = authenticate(request, username=username, password=password)
        
        if user is not None:
            login(request, user)
            messages.success(request, 'Login successful!')
            return redirect('home')
        else:
            messages.error(request, 'Invalid Username or Password')
            return redirect('view_login')
    
    return render(request, 'start_messiging/login.html')
```

**Purpose**: User login functionality

**Method**: GET & POST

**POST Parameters**:
- `username`: User ‡¶è‡¶∞ username
- `password`: User ‡¶è‡¶∞ password

**Process**:
1. Username ‡¶è‡¶¨‡¶Ç password ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá authenticate ‡¶ï‡¶∞‡ßá
2. Valid ‡¶π‡¶≤‡ßá login ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç home page ‡¶è redirect ‡¶ï‡¶∞‡ßá
3. Invalid ‡¶π‡¶≤‡ßá error message ‡¶¶‡ßá‡¶ñ‡¶æ‡¶Ø‡¶º

---

### 3. Signup View
```python
def signup(request):
    if request.method == "POST":
        username = request.POST.get('username')
        name = request.POST.get('name')
        email = request.POST.get('email')
        password = request.POST.get('password1')
        confirm_password = request.POST.get('password2')
        
        if password == confirm_password:
            try:
                if User.objects.filter(username=username).exists():
                    messages.error(request, 'Username already exists')
                    return redirect('signup')
                
                if User.objects.filter(email=email).exists():
                    messages.error(request, 'Email already exists')
                    return redirect('signup')
                
                user = User.objects.create_user(
                    username=username, 
                    email=email,
                    password=password,
                    first_name=name
                )
                user.save()
                
                messages.success(request, 'Account created successfully!')
                return redirect('view_login')
            
            except Exception as e:
                messages.error(request, f'Error creating account: {str(e)}')
                return redirect('signup')
        else:
            messages.error(request, 'Passwords do not match')
            return redirect('signup')
    
    return render(request, 'start_messiging/signup.html')
```

**Purpose**: ‡¶®‡¶§‡ßÅ‡¶® user registration

**POST Parameters**:
- `username`: Unique username
- `name`: User ‡¶è‡¶∞ ‡¶®‡¶æ‡¶Æ
- `email`: Email address
- `password1`: Password
- `password2`: Confirm password

**Validation**:
- Username unique ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
- Email unique ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
- Password match ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá

---

### 4. Connect View
```python
@login_required(login_url='view_login')
def view_connect(request):
    # Get all users except current user
    all_users = User.objects.exclude(id=request.user.id)
    
    # Get friendships
    friendships = Friendship.objects.filter(
        Q(user1=request.user) | Q(user2=request.user)
    )
    
    # Get friend IDs
    friend_ids = []
    for friendship in friendships:
        if friendship.user1 == request.user:
            friend_ids.append(friendship.user2.id)
        else:
            friend_ids.append(friendship.user1.id)
    
    # Get requests
    sent_requests = FriendRequest.objects.filter(from_user=request.user)
    sent_request_ids = [req.to_user.id for req in sent_requests]
    
    received_requests = FriendRequest.objects.filter(to_user=request.user)
    received_request_ids = [req.from_user.id for req in received_requests]
    
    # Available users
    available_users = all_users.exclude(
        id__in=friend_ids + sent_request_ids + received_request_ids
    )
    
    context = {
        'available_users': available_users,
        'sent_requests': sent_requests,
        'received_requests': received_requests,
        'friends': User.objects.filter(id__in=friend_ids)
    }
    
    return render(request, 'start_messiging/connect.html', context)
```

**Purpose**: All users, requests, ‡¶è‡¶¨‡¶Ç friends ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Authentication**: Login required

**Context Variables**:
- `available_users`: ‡¶Ø‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶è‡¶ñ‡¶®‡ßã friend ‡¶®‡¶Ø‡¶º ‡¶è‡¶¨‡¶Ç request pending ‡¶®‡ßá‡¶á
- `sent_requests`: ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã pending requests
- `received_requests`: ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ü‡¶∏‡¶æ requests
- `friends`: ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ friend list

---

### 5. Send Request View
```python
@login_required(login_url='view_login')
def send_request(request, user_id):
    to_user = get_object_or_404(User, id=user_id)
    
    if to_user != request.user:
        FriendRequest.objects.get_or_create(
            from_user=request.user,
            to_user=to_user
        )
        messages.success(request, f'Friend request sent to {to_user.username}')
    
    return redirect('view_connect')
```

**Purpose**: Friend request ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Parameters**: `user_id` - ‡¶Ø‡¶æ‡¶ï‡ßá request ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶π‡¶¨‡ßá

**Process**:
1. User exist ‡¶ï‡¶∞‡ßá ‡¶ï‡¶ø‡¶®‡¶æ check ‡¶ï‡¶∞‡ßá
2. ‡¶®‡¶ø‡¶ú‡ßá‡¶ï‡ßá request ‡¶™‡¶æ‡¶†‡¶æ‡¶§‡ßá ‡¶¶‡ßá‡¶Ø‡¶º ‡¶®‡¶æ
3. `get_or_create` ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá duplicate request prevent ‡¶ï‡¶∞‡ßá

---

### 6. Accept Request View
```python
@login_required(login_url='view_login')
def accept_request(request, request_id):
    friend_request = get_object_or_404(FriendRequest, id=request_id, to_user=request.user)
    
    # Create friendship
    Friendship.objects.create(
        user1=friend_request.from_user,
        user2=request.user
    )
    
    # Delete the request
    friend_request.delete()
    
    messages.success(request, f'You are now friends with {friend_request.from_user.username}')
    return redirect('view_connect')
```

**Purpose**: Friend request accept ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Parameters**: `request_id` - FriendRequest ‡¶è‡¶∞ ID

**Process**:
1. Request ‡¶ü‡¶ø current user ‡¶è‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ verify ‡¶ï‡¶∞‡ßá
2. Friendship create ‡¶ï‡¶∞‡ßá
3. Request delete ‡¶ï‡¶∞‡ßá

---

### 7. Reject Request View
```python
@login_required(login_url='view_login')
def reject_request(request, request_id):
    friend_request = get_object_or_404(FriendRequest, id=request_id, to_user=request.user)
    from_user = friend_request.from_user
    friend_request.delete()
    
    messages.info(request, f'Request from {from_user.username} rejected')
    return redirect('view_connect')
```

**Purpose**: Friend request reject ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Process**: Request ‡¶ü‡¶ø simply delete ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡¶Ø‡¶º

---

### 8. Chat View
```python
@login_required(login_url='view_login')
def chat_view(request, friend_id):
    friend = get_object_or_404(User, id=friend_id)
    
    # Check if they are friends
    is_friend = Friendship.objects.filter(
        Q(user1=request.user, user2=friend) | Q(user1=friend, user2=request.user)
    ).exists()
    
    if not is_friend:
        messages.error(request, 'You can only chat with friends')
        return redirect('view_connect')
    
    # Get all messages
    messages_list = Message.objects.filter(
        Q(sender=request.user, receiver=friend) | Q(sender=friend, receiver=request.user)
    ).order_by('timestamp')
    
    # Mark as read
    Message.objects.filter(sender=friend, receiver=request.user, is_read=False).update(is_read=True)
    
    # Send message
    if request.method == 'POST':
        content = request.POST.get('message')
        if content:
            Message.objects.create(
                sender=request.user,
                receiver=friend,
                content=content
            )
            return redirect('chat_view', friend_id=friend_id)
    
    context = {
        'friend': friend,
        'messages': messages_list
    }
    
    return render(request, 'start_messiging/chat.html', context)
```

**Purpose**: Chat interface ‡¶è‡¶¨‡¶Ç message ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Parameters**: `friend_id` - ‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá chat ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá

**Features**:
- ‡¶∂‡ßÅ‡¶ß‡ßÅ friends ‡¶è‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá chat ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º
- Message history ‡¶¶‡ßá‡¶ñ‡¶æ‡¶Ø‡¶º
- ‡¶®‡¶§‡ßÅ‡¶® message ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶Ø‡¶º
- Unread messages automatically read mark ‡¶ï‡¶∞‡ßá

---

### 9. Get Messages API View
```python
@login_required(login_url='view_login')
def get_messages(request, friend_id):
    from django.http import JsonResponse
    
    friend = get_object_or_404(User, id=friend_id)
    
    # Check friendship
    is_friend = Friendship.objects.filter(
        Q(user1=request.user, user2=friend) | Q(user1=friend, user2=request.user)
    ).exists()
    
    if not is_friend:
        return JsonResponse({'error': 'Not friends'}, status=403)
    
    # Get messages
    messages_list = Message.objects.filter(
        Q(sender=request.user, receiver=friend) | Q(sender=friend, receiver=request.user)
    ).order_by('timestamp')
    
    # Mark as read
    Message.objects.filter(sender=friend, receiver=request.user, is_read=False).update(is_read=True)
    
    # Convert to JSON
    messages_data = []
    for msg in messages_list:
        messages_data.append({
            'id': msg.id,
            'content': msg.content,
            'sender_id': msg.sender.id,
            'timestamp': msg.timestamp.strftime('%I:%M %p')
        })
    
    return JsonResponse({
        'messages': messages_data,
        'current_user_id': request.user.id
    })
```

**Purpose**: AJAX ‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá messages fetch ‡¶ï‡¶∞‡¶æ‡¶∞ API

**Response Format**:
```json
{
  "messages": [
    {
      "id": 1,
      "content": "Hello",
      "sender_id": 2,
      "timestamp": "02:30 PM"
    }
  ],
  "current_user_id": 1
}
```

---

## üîó URLs Configuration

```python
from django.urls import path
from . import views

urlpatterns = [
    path('', views.home, name='home'),
    path('login/', views.view_login, name='view_login'),
    path('signup/', views.signup, name='signup'),
    path('logout/', views.view_logout, name='view_logout'),
    path('connect/', views.view_connect, name='view_connect'),
    path('send-request/<int:user_id>/', views.send_request, name='send_request'),
    path('accept-request/<int:request_id>/', views.accept_request, name='accept_request'),
    path('reject-request/<int:request_id>/', views.reject_request, name='reject_request'),
    path('chat/<int:friend_id>/', views.chat_view, name='chat_view'),
    path('api/messages/<int:friend_id>/', views.get_messages, name='get_messages'),
]
```

### URL Patterns Explanation

| URL | View | Purpose |
|-----|------|---------|
| `/` | home | Landing page |
| `/login/` | view_login | Login page |
| `/signup/` | signup | Registration page |
| `/logout/` | view_logout | Logout functionality |
| `/connect/` | view_connect | Find friends page |
| `/send-request/<id>/` | send_request | Send friend request |
| `/accept-request/<id>/` | accept_request | Accept request |
| `/reject-request/<id>/` | reject_request | Reject request |
| `/chat/<id>/` | chat_view | Chat interface |
| `/api/messages/<id>/` | get_messages | AJAX API endpoint |

---

## üé® Templates Guide

### 1. home.html
**Purpose**: Landing page

**Features**:
- Dynamic content based on authentication status
- Navbar with login/logout options
- Hero section with CTA buttons
- Feature cards
- Message display

**Key Sections**:
```html
<!-- Navbar -->
<nav class="navbar">
  {% if user.is_authenticated %}
    <!-- Show username and logout -->
  {% else %}
    <!-- Show login and signup buttons -->
  {% endif %}
</nav>

<!-- Hero Section -->
<section class="hero">
  {% if user.is_authenticated %}
    <!-- Welcome back message -->
  {% else %}
    <!-- Welcome new user -->
  {% endif %}
</section>
```

---

### 2. login.html
**Purpose**: User login

**Form Fields**:
- Username
- Password

**Features**:
- Error/Success message display
- Link to signup page
- Gradient design
- Form validation

---

### 3. signup.html
**Purpose**: User registration

**Form Fields**:
- Full Name
- Username
- Email
- Password
- Confirm Password

**Features**:
- Password matching validation
- Username uniqueness check
- Email validation
- Link to login page

---

### 4. connect.html
**Purpose**: Friend management

**Sections**:
1. **Friend Requests Received** - Accept/Reject ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
2. **Your Friends** - Chat button ‡¶∏‡¶π friend list
3. **Pending Requests** - ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã requests
4. **Find New Friends** - ‡¶®‡¶§‡ßÅ‡¶® users ‡¶¶‡ßá‡¶∞ list

**Card Structure**:
```html
<div class="user-card">
  <div class="user-avatar">A</div>
  <div class="user-name">Name</div>
  <div class="user-username">@username</div>
  <a href="#" class="btn">Action</a>
</div>
```

---

### 5. chat.html
**Purpose**: Real-time chat interface

**Sections**:
1. **Chat Header** - Friend info ‡¶è‡¶¨‡¶Ç back button
2. **Messages Area** - Message history
3. **Input Area** - Message ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ form

**Message Structure**:
```html
<div class="message sent">
  <div>
    <div class="message-bubble">Message text</div>
    <div class="message-time">02:30 PM</div>
  </div>
</div>
```

---

## ‚ö° AJAX Implementation

### Overview
Chat system ‡¶ü‡¶ø AJAX ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßá real-time messaging support ‡¶ï‡¶∞‡ßá‡•§ Page reload ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá‡¶á messages fetch ‡¶è‡¶¨‡¶Ç send ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡•§

### Key JavaScript Functions

#### 1. Load Messages
```javascript
function loadMessages() {
    fetch('/api/messages/' + friendId + '/')
        .then(function(response) {
            return response.json();
        })
        .then(function(data) {
            var messages = data.messages;
            // Update DOM with new messages
        })
        .catch(function(error) {
            console.error('Error:', error);
        });
}
```

**Purpose**: Background ‡¶è messages fetch ‡¶ï‡¶∞‡ßá

**Process**:
1. API endpoint ‡¶•‡ßá‡¶ï‡ßá JSON data fetch ‡¶ï‡¶∞‡ßá
2. Existing message IDs check ‡¶ï‡¶∞‡ßá
3. ‡¶®‡¶§‡ßÅ‡¶® messages ‡¶∂‡ßÅ‡¶ß‡ßÅ DOM ‡¶è add ‡¶ï‡¶∞‡ßá
4. Auto scroll to bottom

---

#### 2. Send Message
```javascript
messageForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    var message = messageInput.value.trim();
    if (!message) return;
    
    var csrftoken = getCookie('csrftoken');
    var formData = new FormData();
    formData.append('message', message);
    
    fetch('/chat/' + friendId + '/', {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrftoken
        },
        body: formData
    })
    .then(function(response) {
        messageInput.value = '';
        setTimeout(function() {
            loadMessages();
        }, 500);
    });
});
```

**Purpose**: ‡¶®‡¶§‡ßÅ‡¶® message ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

**Process**:
1. Form submit event prevent ‡¶ï‡¶∞‡ßá
2. CSRF token ‡¶∏‡¶π POST request ‡¶ï‡¶∞‡ßá
3. Success ‡¶π‡¶≤‡ßá input field clear ‡¶ï‡¶∞‡ßá
4. 500ms ‡¶™‡¶∞ messages reload ‡¶ï‡¶∞‡ßá

---

#### 3. CSRF Token Handler
```javascript
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
```

**Purpose**: Django CSRF token extract ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø

---

#### 4. Auto-Refresh
```javascript
setInterval(function() {
    loadMessages();
}, 2000);
```

**Purpose**: ‡¶™‡ßç‡¶∞‡¶§‡¶ø 2 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá automatic messages update

**Benefits**:
- Real-time experience
- Input field interrupt ‡¶π‡¶Ø‡¶º ‡¶®‡¶æ
- Minimal server load

---

## üåê API Endpoints

### GET /api/messages/<friend_id>/

**Description**: Get all messages between current user and friend

**Authentication**: Required

**Response**:
```json
{
  "messages": [
    {
      "id": 1,
      "content": "Hello!",
      "sender_id": 2,
      "timestamp": "02:30 PM"
    },
    {
      "id": 2,
      "content": "Hi there!",
      "sender_id": 1,
      "timestamp": "02:31 PM"
    }
  ],
  "current_user_id": 1
}
```

**Error Response**:
```json
{
  "error": "Not friends"
}
```
Status Code: 403

---

## üìñ Usage Guide

### For New Users

#### 1. Create Account
1. Homepage ‡¶è ‡¶Ø‡¶æ‡¶®
2. "Sign Up" button ‡¶è click ‡¶ï‡¶∞‡ßÅ‡¶®
3. ‡¶∏‡¶¨ information fill ‡¶ï‡¶∞‡ßÅ‡¶®:
   - Full Name
   - Username (unique ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá)
   - Email (unique ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá)
   - Password
   - Confirm Password
4. "Create Account" button ‡¶è click ‡¶ï‡¶∞‡ßÅ‡¶®
5. Success message ‡¶¶‡ßá‡¶ñ‡¶≤‡ßá login page ‡¶è redirect ‡¶π‡¶¨‡ßá

#### 2. Login
1. Username ‡¶è‡¶¨‡¶Ç Password ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá login ‡¶ï‡¶∞‡ßÅ‡¶®
2. Success ‡¶π‡¶≤‡ßá home page ‡¶è redirect ‡¶π‡¶¨‡ßá

#### 3. Find Friends
1. "Start Chatting" ‡¶¨‡¶æ "View Contacts" button ‡¶è click ‡¶ï‡¶∞‡ßÅ‡¶®
2. "Find New Friends" section ‡¶è ‡¶∏‡¶¨ available users ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
3. "+ Add Friend" button ‡¶è click ‡¶ï‡¶∞‡ßá request ‡¶™‡¶æ‡¶†‡¶æ‡¶®

#### 4. Accept Requests
1. Connect page ‡¶è "Friend Requests" section check ‡¶ï‡¶∞‡ßÅ‡¶®
2. "‚úì Accept" button ‡¶è click ‡¶ï‡¶∞‡ßá accept ‡¶ï‡¶∞‡ßÅ‡¶®
3. "‚úó Reject" button ‡¶è click ‡¶ï‡¶∞‡ßá reject ‡¶ï‡¶∞‡ßÅ‡¶®

#### 5. Start Chatting
1. "Your Friends" section ‡¶è ‡¶Ø‡¶æ‡¶®
2. ‡¶Ø‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá chat ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶® ‡¶§‡¶æ‡¶∞ "üí¨ Chat Now" button ‡¶è click ‡¶ï‡¶∞‡ßÅ‡¶®
3. Message type ‡¶ï‡¶∞‡ßá "‚û§" button ‡¶è click ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ Enter press ‡¶ï‡¶∞‡ßÅ‡¶®
4. Messages automatically update ‡¶π‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø 2 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá

---

## üîß Troubleshooting

### Common Issues and Solutions

#### 1. Messages Not Updating
**Problem**: ‡¶®‡¶§‡ßÅ‡¶® messages automatically ‡¶Ü‡¶∏‡¶õ‡ßá ‡¶®‡¶æ

**Solutions**:
- Browser console check ‡¶ï‡¶∞‡ßÅ‡¶® error ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
- Network tab check ‡¶ï‡¶∞‡ßÅ‡¶® API call ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ
- AJAX interval ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ö‡¶≤‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ verify ‡¶ï‡¶∞‡ßÅ‡¶®

```javascript
// Console ‡¶è ‡¶è‡¶á line ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶â‡¶ö‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø 2 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá
console.log('Checking for new messages...');
```

---

#### 2. CSRF Token Error
**Problem**: POST request ‡¶è 403 Forbidden error

**Solution**:
- `{% csrf_token %}` form ‡¶è ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ check ‡¶ï‡¶∞‡ßÅ‡¶®
- `getCookie()` function ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ verify ‡¶ï‡¶∞‡ßÅ‡¶®

```python
# settings.py ‡¶§‡ßá verify ‡¶ï‡¶∞‡ßÅ‡¶®
MIDDLEWARE = [
    ...
    'django.middleware.csrf.CsrfViewMiddleware',
    ...
]
```

---

#### 3. Static Files Not Loading
**Problem**: CSS/JS load ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶®‡¶æ

**Solution**:
```python
# settings.py
STATIC_URL = '/static/'
STATICFILES_DIRS = [BASE_DIR / "static"]

# Development ‡¶è
python manage.py collectstatic
```

---

#### 4. Database Migration Errors
**Problem**: Models change ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶™‡¶∞ error

**Solution**:
```bash
# Delete existing migrations (except __init__.py)
# Then run:
python manage.py makemigrations
python manage.py migrate

# ‡¶Ø‡¶¶‡¶ø ‡¶è‡¶ñ‡¶®‡ßã issue ‡¶•‡¶æ‡¶ï‡ßá:
python manage.py migrate --run-syncdb
```

---

#### 5. Friend Request Duplicate Error
**Problem**: Same user ‡¶ï‡ßá multiple requests ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶ö‡ßç‡¶õ‡ßá

**Solution**: Model ‡¶è `unique_together` ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ check ‡¶ï‡¶∞‡ßÅ‡¶®
```python
class FriendRequest(models.Model):
    # ...
    class Meta:
        unique_together = ('from_user', 'to_user')
```

---

#### 6. Chat Page Not Accessible
**Problem**: Chat ‡¶ï‡¶∞‡¶§‡ßá ‡¶ó‡ßá‡¶≤‡ßá error ‡¶Ü‡¶∏‡¶õ‡ßá

**Checks**:
1. ‡¶¶‡ßÅ‡¶á‡¶ú‡¶® ‡¶ï‡¶ø friend?
2. `@login_required` decorator ‡¶Ü‡¶õ‡ßá ‡¶ï‡¶ø‡¶®‡¶æ?
3. Friendship model ‡¶∏‡¶†‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá configured ‡¶ï‡¶ø‡¶®‡¶æ?

---

### Debug Mode

Development ‡¶è debug ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø:

```python
# settings.py
DEBUG = True

# Console ‡¶è detailed error ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'handlers': {
        'console': {
            'class': 'logging.StreamHandler',
        },
    },
    'root': {
        'handlers': ['console'],
        'level': 'DEBUG',
    },
}
```

---

## üéØ Best Practices

### Security
1. ‚úÖ Always use `@login_required`